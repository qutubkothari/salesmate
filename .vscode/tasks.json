{
	"version": "2.0.0",
	"tasks": [
		{
			"label": "Deploy to EC2",
			"type": "shell",
			"command": "powershell.exe",
			"args": [
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/deploy-to-ec2.ps1",
				"-Message",
				"Auto-deploy: ${input:commitMessage}"
			],
			"problemMatcher": [],
			"presentation": {
				"reveal": "always",
				"panel": "new",
				"focus": false
			}
		},
		{
			"label": "Quick Deploy (no message)",
			"type": "shell",
			"command": "powershell.exe",
			"args": [
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/deploy-to-ec2.ps1"
			],
			"problemMatcher": [],
			"presentation": {
				"reveal": "always",
				"panel": "new",
				"focus": false
			}
		},
		{
			"label": "Kill Salesmate node processes",
			"type": "shell",
			"command": "powershell.exe",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-Command",
				"$procs = Get-CimInstance Win32_Process -Filter \"Name='node.exe'\" | Where-Object { $_.CommandLine -match 'Documents\\\\GitHub\\\\salesmate' }; if ($procs) { $procs | ForEach-Object { Stop-Process -Id $_.ProcessId -Force -ErrorAction SilentlyContinue }; Write-Host \"Killed $($procs.Count) salesmate node process(es).\" } else { Write-Host \"No salesmate node processes found.\" }"
			],
			"isBackground": false
		},
		{
			"label": "Deploy to Hostinger VPS",
			"type": "shell",
			"command": "powershell.exe",
			"args": [
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}\\deploy-salesmate-hostinger.ps1",
				"-Message",
				"Auto-deploy: salesman auth + offline sync + notifications"
			],
			"isBackground": false
		},
		{
			"label": "Deploy to Hostinger VPS (auto)",
			"type": "shell",
			"command": "powershell.exe",
			"args": [
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/deploy-salesmate-hostinger.ps1",
				"-Message",
				"Auto-deploy: all logins phone+password"
			],
			"isBackground": false
		},
		{
			"label": "Deploy to Hostinger VPS (salesman pwd enforce)",
			"type": "shell",
			"command": "powershell.exe",
			"args": [
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/deploy-salesmate-hostinger.ps1",
				"-Message",
				"Auto-deploy: enforce salesman phone+password"
			],
			"isBackground": false
		},
		{
			"label": "Deploy to Hostinger VPS",
			"type": "shell",
			"command": "powershell.exe",
			"args": [
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/deploy-salesmate-hostinger.ps1",
				"-Message",
				"Auto-deploy: fix salesman phone match"
			],
			"isBackground": false
		},
		{
			"label": "Deploy to Hostinger VPS (add salesman pwd tool)",
			"type": "shell",
			"command": "powershell.exe",
			"args": [
				"-ExecutionPolicy",
				"Bypass",
				"-File",
				"${workspaceFolder}/deploy-salesmate-hostinger.ps1",
				"-Message",
				"Auto-deploy: add salesman password tool"
			],
			"isBackground": false
		},
		{
			"label": "SSH: set salesman pwd 8484830022",
			"type": "shell",
			"command": "powershell.exe",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-Command",
				"$key = Join-Path $env:USERPROFILE '.ssh\\hostinger_ed25519'; ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i $key qutubk@72.62.192.228 \"cd /var/www/salesmate-ai && node tools/set_salesman_password_sqlite.js --phone 8484830022 --password 'Sales@1234'\""
			],
			"isBackground": false
		},
		{
			"label": "SSH: set salesman pwd 8484830022 (fixed quoting)",
			"type": "shell",
			"command": "powershell.exe",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-Command",
				"$key = Join-Path $env:USERPROFILE \".ssh\\hostinger_ed25519\"; ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i $key qutubk@72.62.192.228 \"cd /var/www/salesmate-ai; node tools/set_salesman_password_sqlite.js --phone 8484830022 --password \\\"Sales@1234\\\"\""
			],
			"isBackground": false
		},
		{
			"label": "SSH: verify salesman/user rows 8484830022",
			"type": "shell",
			"command": "powershell.exe",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-Command",
				"$key = Join-Path $env:USERPROFILE \".ssh\\hostinger_ed25519\"; ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i $key qutubk@72.62.192.228 \"cd /var/www/salesmate-ai; sqlite3 local-database.db \\\"select s.id, s.tenant_id, s.user_id, s.phone, u.phone, u.role, length(u.password_hash) as pw_len from salesmen s left join users u on u.id = s.user_id where s.id = '27a44053-3f43-4ba3-9213-2dae0870de11' limit 1;\\\"\""
			],
			"isBackground": false
		},
		{
			"label": "SSH: verify salesman/user rows 8484830022 (fixed)",
			"type": "shell",
			"command": "powershell.exe",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-Command",
				"$key = Join-Path $env:USERPROFILE \".ssh\\hostinger_ed25519\"; ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i $key qutubk@72.62.192.228 \"cd /var/www/salesmate-ai; sqlite3 local-database.db 'select s.id, s.tenant_id, s.user_id, s.phone, u.phone, u.role, length(u.password_hash) as pw_len from salesmen s left join users u on u.id = s.user_id where s.phone like ''%8484830022%'' limit 5;'\""
			],
			"isBackground": false
		},
		{
			"label": "Kill all node.exe",
			"type": "shell",
			"command": "powershell.exe",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-Command",
				"taskkill /F /IM node.exe"
			],
			"isBackground": false
		},
		{
			"label": "SSH: inspect users phone 8484830022",
			"type": "shell",
			"command": "powershell.exe",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-Command",
				"$key = Join-Path $env:USERPROFILE \".ssh\\hostinger_ed25519\"; ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i $key qutubk@72.62.192.228 \"cd /var/www/salesmate-ai; sqlite3 -header -column local-database.db \\\"select id, tenant_id, phone, role, is_active, length(password_hash) as pw_len from users where phone like '%8484830022%' or phone like '%484830022%';\\\"\""
			],
			"isBackground": false
		},
		{
			"label": "SSH: inspect users phone 8484830022 (fixed)",
			"type": "shell",
			"command": "powershell.exe",
			"args": [
				"-NoProfile",
				"-ExecutionPolicy",
				"Bypass",
				"-Command",
				"$key = Join-Path $env:USERPROFILE \".ssh\\hostinger_ed25519\"; ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -i $key qutubk@72.62.192.228 \"cd /var/www/salesmate-ai; sqlite3 -header -column local-database.db 'select id, tenant_id, phone, role, is_active, length(password_hash) as pw_len from users where phone like ''%8484830022%'' or phone like ''%484830022%'';'\""
			],
			"isBackground": false
		}
	],
	"inputs": [
		{
			"id": "commitMessage",
			"type": "promptString",
			"description": "Commit message:",
			"default": "Quick update"
		}
	]
}